
---

# 📺 跨平台直播自动录制控制台 (Live Stream Recorder)

这是一个基于 Go + Vue 3 + Arco Design 开发的**轻量级、跨平台直播自动录制工具**。通过内置的高颜值 Web 控制台，你可以像看监控探头一样，轻松管理多平台的直播监控与录制任务。

## ✨ 核心功能 (Core Features)

* 🌐 **多平台支持**：目前稳定支持 抖音 (Douyin)、快手 (Kuaishou)、Soop (AfreecaTV)。
* ⚡ **WebSocket 毫秒级实时推送**：彻底告别传统 HTTP 定时轮询，采用 WebSocket 长连接，实现录制状态、文件大小、监控启停的**毫秒级无延迟同步**，同时大幅降低服务器并发与性能开销。
* 🖼️ **真实直播流纯净截帧**：突破平台 API 防盗链与接口结构频繁变动的限制。只要处于录制状态，后台会自动利用 FFmpeg 引擎**每隔 20 秒从真实的视频流中异步提取一帧实时画面**，让你在面板上实时纵览所有直播间的真实画面。
* 📱 **完美移动端自适应**：精心调优的响应式布局，无论是在 PC 宽屏还是在手机浏览器上，都能获得极佳的触控交互与紧凑的信息展示体验。
* 🎨 **现代超高颜值 Web UI & 专属 Logo**：采用 Arco Design 构建，融入时下前沿的 **毛玻璃 (Glassmorphism)** 拟物化视觉效果，并内置了纯代码绘制的精美 SVG 电视机 Logo。前端页面直接编译打包进 Go 程序中，真正的**单文件绿色运行**。
* 💾 **智能持久化记忆机制**：程序首次抓取到主播真实昵称后，会自动写入本地 `urls.txt` 进行持久化保存。重启服务时瞬间加载，彻底省去二次网络请求的等待时间。
* 🤖 **智能 FFmpeg 检测**：无需繁琐配置系统环境变量，只需将 `ffmpeg.exe` 放在程序同级目录，系统即可自动识别并接管录制与截帧任务。
* ⚙️ **高级录制控制**：
  * 支持自定义默认画质（蓝光/超清、高清、标清）。
  * 支持**视频无损分片**（例如每 15 分钟自动切割生成新文件，防丢失、防漏帧）。
  * 支持自定义录制文件保存路径（绝对路径或相对路径）。
  * 支持对指定任务进行 **单点暂停、恢复、永久删除** 操作。
* 🍪 **反风控机制**：支持在 Web 面板中直接热更新浏览器 Cookie，轻松解决抖音、快手等平台的验证码或登录风控问题。

---

## 🛠️ 安装与运行指南

### 1. 环境准备 (必须)

本程序的核心录制与截帧引擎依赖 **FFmpeg**。

* 请前往 [FFmpeg 官网](https://ffmpeg.org/download.html) 下载对应系统版本的可执行文件。
* **Windows 用户最简方案**：下载压缩包后解压，在 `bin` 目录下找到 `ffmpeg.exe`，直接将其**复制到本程序的同级目录**下即可（程序会自动识别，免配环境变量！）。

### 2. 获取依赖库 (源码运行/编译前必须执行)

本项目使用了 Gorilla WebSocket 库进行超低延迟的实时通信，请先在终端拉取该依赖：

```bash
go get [github.com/gorilla/websocket](https://github.com/gorilla/websocket)

```

### 3. 启动服务

你可以直接运行源码，或者将其编译成单文件二进制可执行程序：

**直接运行源码：**

```bash
# 进入项目目录
cd live-recorder
# 运行程序
go run main.go
```

**编译为单文件（推荐）：**

```bash
go build -o live-recorder.exe main.go
# 运行编译后的程序
./live-recorder.exe
```

### 4. 访问控制台

启动成功后，控制台会输出监听端口。打开浏览器（电脑或手机均可）访问：
👉 **http://localhost:9091** （如果是部署在云服务器/软路由上，请将 `localhost` 替换为服务器的具体 IP）。

---

## 📖 使用说明

1. **基础设置**：
* 第一次使用时，建议在左上角的“基础设置”中配置你的**录制保存路径**（如 `D:\Downloads` 或 `./downloads`）。
* 设定**自动分片时长**（建议 15-30 分钟，设为 0 则为不分片，一录到底）。
* *注意：修改分片配置后，如果任务正在录制中，请在右侧点击【暂停】等待状态变更后，再点击【恢复】，新配置即可立即生效。*


2. **添加监控任务**：
* 选择平台，粘贴直播间的**完整网址**或**纯数字 ID**。
* 点击“立即添加”，程序会自动拉取主播信息并进入“监控中”或“未开播等待中”的状态。


3. **解决无法录制（Cookie 热更新）**：
* 如果长时间卡在“监控中”但确定主播已经开播，可能是触发了平台风控要求验证身份。
* 打开浏览器，登录对应平台的网页版，按 `F12` 抓取网络请求头中的 `Cookie`，粘贴到面板的【身份验证 (Cookie)】页签中并保存即可热生效。



---

## 📁 目录结构说明

```text
live-recorder/
├── main.go            # 后端 Go 核心逻辑 (API、WebSocket推送、监控调度、FFmpeg截帧与录制控制)
├── index.html         # 前端 Vue 3 界面 (编译时通过 //go:embed 魔法自动打包入 exe)
├── go.mod             # Go 模块依赖管理
├── config.json        # 自动生成的持久化基础配置文件 
├── cookies.json       # 自动生成的 Cookie 保存文件 
├── urls.txt           # 自动生成的主播监控列表记忆文件 (带有智能追加的主播名)
├── covers/            # 自动生成的存放实时直播截帧画面的静态资源目录 (运行后产生)
└── ffmpeg.exe         # 需要用户自行放入的底层多媒体处理引擎

```

---

## ❓ 常见问题排查 (FAQ)

**Q1: 为什么状态显示“录制中”，但录制时长一直是 00:00，并且立马变成了“异常/断流等待中”？**

> **A:** 你的电脑或同级目录下没有找到 FFmpeg 工具。请下载 `ffmpeg.exe` 并将其放到与 `main.go` / `live-recorder.exe` 同一个文件夹下。

**Q2: 为什么我的录制时长和文件大小显示空白（只有小图标），或者点击按钮又弹回去了？**

> **A:** 请确保前端和后端的代码版本一致。如果你更新了 `index.html`，必须**彻底重启 Go 服务**才能让新接口和 WebSocket 链路生效。

**Q3: 修改了自动分片时长（比如改成 15 分钟），为什么没有生效切片？**

> **A:** 修改基础配置不会打断**正在进行中**的底层录制进程。请在面板列表中找到该主播，点击操作列的**【已停止】开关（即暂停）**，等待状态同步后，再点击**【开启】（即恢复）**，即可触发并应用新的切片配置。

**Q4: 列表里的图片显示“封面失效”或者一直是一个写着“无画面”的灰色方框？**

> **A:** 这通常发生在主播**刚开播**或者**刚被添加到监控列表尚未抓取到流**时。不用担心，由于我们采用了“真实视频流截帧”技术，只要主播成功进入“正在录制”状态，后台的定时截帧机制会在 20 秒内自动调用 FFmpeg 捕获最高清的实时画面并原地替换它。

---

## 📺 视频教程

### [Bilibili 演示视频](https://www.bilibili.com/video/BV1jRftBxErk/?vd_source=9ee16bb9a48c7459901bbe5fe120efd4)

## ⚠️ 免责声明

本工具仅供个人学习、技术研究与自动化测试使用。请勿将录制的视频用于商业用途或侵犯他人知识产权。使用本工具所产生的一切法律及相关后果由使用者自行承担。

